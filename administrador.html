<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CREACTIVEPACK | ADMIN PRO</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Quicksand:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root { --neon: #00f2fe; --p: #ff007f; --bg: #050a18; --card: rgba(30, 41, 59, 0.7); }
        body { font-family: 'Quicksand', sans-serif; background: var(--bg); color: white; margin: 0; background-image: radial-gradient(circle at top right, #1e293b, #050a18); min-height: 100vh; }
        header { padding: 20px; text-align: center; border-bottom: 1px solid rgba(255,255,255,0.1); backdrop-filter: blur(10px); }
        .nav-tabs { display: flex; background: rgba(15, 23, 42, 0.9); padding: 5px; gap: 5px; overflow-x: auto; }
        .tab-btn { flex: 1; min-width: 80px; padding: 12px 5px; border: none; background: transparent; color: #64748b; font-weight: bold; font-size: 0.65rem; border-radius: 10px; cursor: pointer; }
        .tab-btn.active { background: var(--p); color: white; box-shadow: 0 0 15px var(--p); }
        .container { padding: 20px; padding-bottom: 100px; }
        .glass-card { background: var(--card); backdrop-filter: blur(15px); border-radius: 20px; padding: 20px; border: 1px solid rgba(255,255,255,0.1); margin-bottom: 20px; }
        input, select { width: 100%; padding: 12px; background: rgba(0,0,0,0.3); border: 1px solid #334155; border-radius: 12px; color: white; margin-bottom: 10px; box-sizing: border-box; }
        .btn-action { width: 100%; padding: 15px; border-radius: 12px; border: none; font-weight: bold; cursor: pointer; transition: 0.3s; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .btn-cam { background: linear-gradient(45deg, #10b981, #059669); color: white; }
        .btn-add { background: var(--p); color: white; }
        .btn-publish { position: fixed; bottom: 20px; left: 5%; width: 90%; background: linear-gradient(45deg, var(--neon), #7000ff); color: white; padding: 18px; border-radius: 15px; font-weight: bold; border: none; box-shadow: 0 0 20px rgba(0, 242, 254, 0.4); z-index: 100; }
        .item-preview { display: flex; gap: 15px; background: rgba(255,255,255,0.05); padding: 10px; border-radius: 15px; margin-bottom: 10px; border-left: 4px solid var(--neon); }
        .item-preview img { width: 50px; height: 50px; border-radius: 8px; object-fit: cover; }
    </style>
</head>
<body>

    <header>
        <h1 style="font-family:'Orbitron'; font-size:1.1rem; color:var(--neon);">CREACTIVEPACK ADMIN</h1>
    </header>

    <nav class="nav-tabs">
        <button class="tab-btn active" onclick="showTab('tecni')">TECNI</button>
        <button class="tab-btn" onclick="showTab('regalos')">REGALOS</button>
        <button class="tab-btn" onclick="showTab('seguridad')">SEGURIDAD</button>
        <button class="tab-btn" onclick="showTab('list')">REVISAR</button>
    </nav>

    <div class="container">
        <div class="glass-card">
            <h2 style="font-size:0.8rem; color:var(--neon);">ðŸ“¸ MULTIMEDIA (AHORRO MEGAS)</h2>
            <div id="upStatus" style="font-size: 0.7rem; margin-bottom: 10px; text-align: center;">Listo para capturar</div>
            <input type="file" id="camInput" accept="image/*" style="display:none" onchange="uploadToImgBB(this)">
            <button class="btn-action btn-cam" onclick="document.getElementById('camInput').click()">ðŸ“· TOMAR/SUBIR FOTO</button>
            <input type="hidden" id="tempUrl">
        </div>

        <div id="tecni" class="tab-content">
            <div class="glass-card">
                <input type="text" id="tName" placeholder="Nombre del producto">
                <input type="number" id="tPrice" placeholder="Precio RD$">
                <button class="btn-action btn-add" onclick="pushItem('tName', 'tPrice', '#00f2fe')">AÃ‘ADIR PRODUCTO</button>
            </div>
        </div>

        <div id="seguridad" class="tab-content" style="display:none">
            <div class="glass-card">
                <h2 style="font-size:0.8rem; color:var(--neon);">ðŸ›µ FOTOS DE CONFIANZA</h2>
                <input type="text" id="sName" placeholder="Nombre de la persona/localidad">
                <button class="btn-action btn-add" style="background:orange" onclick="pushItem('sName', null, 'orange')">AÃ‘ADIR A SEGURIDAD</button>
            </div>
        </div>

        <div id="list" class="tab-content" style="display:none">
            <div class="glass-card">
                <div id="renderList"></div>
            </div>
        </div>
    </div>

    <button class="btn-publish" id="masterPublish">ðŸš€ PUBLICAR CAMBIOS</button>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAw4aqJDVXyPnwv4se7J_cmJVbnwRw6gYw",
            authDomain: "creactivepackweb.firebaseapp.com",
            projectId: "creactivepackweb",
            storageBucket: "creactivepackweb.firebasestorage.app",
            messagingSenderId: "100899007718",
            appId: "1:100899007718:web:ea20959af8421e756b9f27"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const IMGBB_API = "c2be55964edd213f2858c698b15a6c9d"; 

        window.uploadToImgBB = async (input) => {
            const file = input.files[0];
            if(!file) return;
            const status = document.getElementById('upStatus');
            status.innerHTML = "â³ SUBIENDO Y AHORRANDO MEGAS...";
            
            const formData = new FormData();
            formData.append("image", file);

            try {
                const res = await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_API}`, {
                    method: "POST",
                    body: formData
                });
                const data = await res.json();
                document.getElementById('tempUrl').value = data.data.url;
                status.innerHTML = "âœ… FOTO LISTA (LOW QUALITY)";
            } catch (e) { 
                status.innerHTML = "âŒ ERROR: Revisa tu conexiÃ³n o la API";
                console.error(e);
            }
        }

        window.showTab = (id) => {
            document.querySelectorAll('.tab-content').forEach(c => c.style.display = 'none');
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).style.display = 'block';
            event.currentTarget.classList.add('active');
        }

        window.pushItem = (idN, idP, color) => {
            const name = document.getElementById(idN).value;
            const price = idP ? document.getElementById(idP).value : "";
            const img = document.getElementById('tempUrl').value;
            if(!name || !img) return alert("Falta nombre o foto");

            const div = document.createElement('div');
            div.className = "item-preview";
            div.style.borderLeftColor = color;
            div.innerHTML = `<img src="${img}"><div><b>${name}</b><br><small>RD$ ${price}</small></div>`;
            document.getElementById('renderList').prepend(div);
            alert("AÃ±adido a la lista");
        }

        document.getElementById('masterPublish').onclick = async () => {
            const html = document.getElementById('renderList').innerHTML;
            if(!html) return alert("Nada que publicar");
            try {
                await setDoc(doc(db, "configuracion", "web_data"), {
                    htmlEstructura: html,
                    ultimaActualizacion: new Date().getTime()
                });
                alert("ðŸš€ Â¡WEB ACTUALIZADA!");
                location.reload();
            } catch (e) { alert("Error al guardar en Firebase"); }
        }
    </script>
</body>
</html>
